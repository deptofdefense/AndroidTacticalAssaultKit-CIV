/*
 * This file was generated by the Gradle 'init' task.
 *
 * This generated file contains a sample Java project to get you started.
 * For more details take a look at the Java Quickstart chapter in the Gradle
 * User Manual available at https://docs.gradle.org/5.4.1/userguide/tutorial_java_projects.html
 */

apply plugin: 'java'

repositories {
    // Use jcenter for resolving your dependencies.
    // You can declare any Maven/Ivy/file repository here.
    jcenter()
}

sourceSets {
    main {
        java {
            // stub source files, excluded from output
            srcDirs 'src/stub/java'

            // external source files, copied from ATAK codebase, excluded from output
            srcDirs 'src/external/java'

            // main source files, included in output
            srcDirs 'src/main/java'
        }
    }
    test {
        java {
            srcDirs 'src/main/test'
        }
    }
}

dependencies {
    // This dependency is found on compile classpath of this component and consumers.
    implementation("com.google.guava:guava:27.0.1-jre")

    // XML pull parser
    compile "net.sf.kxml:kxml2:2.3.0"

    // org.json
    compile("org.json:json:20190722")

    // apache http client
    compile("org.apache.httpcomponents:httpclient:4.5.12")

    // bouncycastle (BKS keystore)
    compile("org.bouncycastle:bcprov-jdk15on:1.65")
    compile("org.bouncycastle:bcpkix-jdk15on:1.65")
    compile("org.bouncycastle:bcpkix-jdk15on:1.65")

    // Use JUnit test framework
    testImplementation("junit:junit:4.12")

    implementation project(':takengine-support-android')
}


test {
    useJUnit()
    maxHeapSize = '1G'
}

jar {
    exclude 'com/atakmap/annotations/DeprecatedApi.class'
    exclude 'com/atakmap/annotations/DeprecatedApi$*.class'
    exclude 'com/atakmap/database/Bindable.class'
    exclude 'com/atakmap/database/Bindable$*.class'
    exclude 'com/atakmap/database/CursorIface.class'
    exclude 'com/atakmap/database/CursorIface$*.class'
    exclude 'com/atakmap/database/DatabaseIface.class'
    exclude 'com/atakmap/database/DatabaseIface$*.class'
    exclude 'com/atakmap/database/Databases.class'
    exclude 'com/atakmap/database/Databases$*.class'
    exclude 'com/atakmap/database/QueryIface.class'
    exclude 'com/atakmap/database/QueryIface$*.class'
    exclude 'com/atakmap/database/RowIterator.class'
    exclude 'com/atakmap/database/RowIterator$*.class'
    exclude 'com/atakmap/database/StatementIface.class'
    exclude 'com/atakmap/database/StatementIface$*.class'
    exclude 'com/atakmap/filesystem/HashingUtils.class'
    exclude 'com/atakmap/filesystem/HashingUtils$*.class'
    exclude 'com/atakmap/io/ZipVirtualFile.class'
    exclude 'com/atakmap/io/ZipVirtualFile$*.class'
    exclude 'com/atakmap/interop/Pointer.class'
    exclude 'com/atakmap/interop/Pointer$*.class'
    exclude 'com/atakmap/map/Globe.class'
    exclude 'com/atakmap/map/Globe$*.class'
    exclude 'com/atakmap/map/MapRenderer.class'
    exclude 'com/atakmap/map/MapRenderer$*.class'
    exclude 'com/atakmap/map/MapRendererBase.class'
    exclude 'com/atakmap/map/MapRendererBase$*.class'
    exclude 'com/atakmap/map/RenderContext.class'
    exclude 'com/atakmap/map/RenderContext$*.class'
    exclude 'com/atakmap/map/RenderSurface.class'
    exclude 'com/atakmap/map/RenderSurface$*.class'
    exclude 'com/atakmap/map/MapControl.class'
    exclude 'com/atakmap/map/MapControl$*.class'
    exclude 'com/atakmap/map/layer/Layer.class'
    exclude 'com/atakmap/map/layer/Layer$*.class'
    exclude 'com/atakmap/map/layer/Layer2.class'
    exclude 'com/atakmap/map/layer/Layer2$*.class'
    exclude 'com/atakmap/map/projection/Projection.class'
    exclude 'com/atakmap/map/projection/Projection$*.class'
    exclude 'com/atakmap/net/AtakAuthenticationDatabase.class'
    exclude 'com/atakmap/net/AtakAuthenticationDatabase$*.class'
    exclude 'com/atakmap/util/ConfigOptions.class'
    exclude 'com/atakmap/util/ConfigOptions$*.class'
    exclude 'com/atakmap/util/Collections2.class'
    exclude 'com/atakmap/util/Collections2$*.class'
    exclude 'com/atakmap/util/Visitor.class'
    exclude 'com/atakmap/util/Visitor$*.class'
    exclude 'com/atakmap/util/ReferenceCount.class'
    exclude 'com/atakmap/util/ReferenceCount$*.class'
    exclude 'com/atakmap/util/zip/ZipEntry.class'
    exclude 'com/atakmap/util/zip/ZipEntry$*.class'
    exclude 'com/atakmap/util/zip/ZipFile.class'
    exclude 'com/atakmap/util/zip/ZipFile$*.class'
    exclude 'com/atakmap/net/AtakAuthenticationCredentials.class'
    exclude 'com/atakmap/net/AtakAuthenticationCredentials$*.class'
    exclude 'com/atakmap/net/AtakAuthenticationDatabaseIFace.class'
    exclude 'com/atakmap/net/AtakAuthenticationDatabaseIFace$*.class'
    exclude 'com/atakmap/net/AtakCertificateDatabaseIFace.class'
    exclude 'com/atakmap/net/AtakCertificateDatabaseIFace$*.class'
    exclude 'com/atakmap/net/CertificateManager.class'
    exclude 'com/atakmap/net/CertificateManager$*.class'
    exclude 'com/atakmap/net/KeyManagerFactoryIFace.class'
    exclude 'com/atakmap/net/KeyManagerFactoryIFace$*.class'
    exclude 'com/atakmap/comms/NetConnectString.class'
    exclude 'com/atakmap/comms/NetConnectString$*.class'
    exclude 'com/atakmap/coremap/concurrent/NamedThreadFactory.class'
    exclude 'com/atakmap/coremap/concurrent/NamedThreadFactory$*.class'
    exclude 'com/atakmap/coremap/filesystem/FileSystemUtils.class'
    exclude 'com/atakmap/coremap/filesystem/FileSystemUtils$*.class'
    exclude 'com/atakmap/coremap/filesystem/SecureDelete.class'
    exclude 'com/atakmap/coremap/filesystem/SecureDelete$*.class'
    exclude 'com/atakmap/coremap/filesystem/SecureDeleteEvent.class'
    exclude 'com/atakmap/coremap/filesystem/SecureDeleteEvent$*.class'
    exclude 'com/atakmap/coremap/filesystem/SecureDeleteThread.class'
    exclude 'com/atakmap/coremap/filesystem/SecureDeleteThread$*.class'
    exclude 'com/atakmap/coremap/io/DatabaseInformation.class'
    exclude 'com/atakmap/coremap/io/DatabaseInformation$*.class'
    exclude 'com/atakmap/coremap/io/DefaultIOProvider.class'
    exclude 'com/atakmap/coremap/io/DefaultOProvider$*.class'
    exclude 'com/atakmap/coremap/io/IOProvider.class'
    exclude 'com/atakmap/coremap/io/IOProvider$*.class'
    exclude 'com/atakmap/coremap/io/IOProviderFactory.class'
    exclude 'com/atakmap/coremap/io/IOProviderFactory$*.class'
    exclude 'com/atakmap/coremap/io/ProviderChangeRequestedListener.class'
    exclude 'com/atakmap/coremap/io/ProviderChangeRequestedListener$*.class'
    exclude 'com/atakmap/coremap/locale/LocaleUtil.class'
    exclude 'com/atakmap/coremap/locale/LocaleUtil$*.class'
    exclude 'com/atakmap/coremap/log/Log.class'
    exclude 'com/atakmap/coremap/log/Log$*.class'
    exclude 'com/atakmap/coremap/maps/time/CoordinatedTime.class'
    exclude 'com/atakmap/coremap/maps/time/CoordinatedTime$*.class'
}

task importDepends {
    doLast {
        // XXX - use config file
        copy {
            from('../../../../../ATAK/ATAKMapEngine/lib/src/main/java') {
                include 'com/atakmap/filesystem/HashingUtils.java'
                include 'com/atakmap/map/MapRenderer.java'
                include 'com/atakmap/map/MapRendererBase.java'
                include 'com/atakmap/map/RenderContext.java'
                include 'com/atakmap/map/RenderSurface.java'
                include 'com/atakmap/map/MapControl.java'
                include 'com/atakmap/map/layer/Layer.java'
                include 'com/atakmap/map/layer/Layer2.java'
                include 'com/atakmap/util/ReferenceCount.java'
                include 'com/atakmap/util/ConfigOptions.java'
                include 'com/atakmap/util/Visitor.java'
            }
            from('../../../../../ATAK/MapCoreInterfaces/lib/src/main/java') {
                include 'com/atakmap/annotations/DeprecatedApi.java'
                include 'com/atakmap/comms/NetConnectString.java'
                include 'com/atakmap/database/Bindable.java'
                include 'com/atakmap/database/CursorIface.java'
                include 'com/atakmap/database/DatabaseIface.java'
                include 'com/atakmap/database/QueryIface.java'
                include 'com/atakmap/database/RowIterator.java'
                include 'com/atakmap/database/StatementIface.java'
                include 'com/atakmap/net/AtakAuthenticationCredentials.java'
                include 'com/atakmap/net/AtakAuthenticationDatabaseIFace.java'
                include 'com/atakmap/net/AtakCertificateDatabaseIFace.java'
                include 'com/atakmap/net/CertificateManager.java'
                include 'com/atakmap/net/KeyManagerFactoryIFace.java'
                include 'com/atakmap/coremap/concurrent/NamedThreadFactory.java'
                include 'com/atakmap/coremap/filesystem/FileSystemUtils.java'
                include 'com/atakmap/coremap/filesystem/SecureDelete.java'
                include 'com/atakmap/coremap/filesystem/SecureDeleteEvent.java'
                include 'com/atakmap/coremap/filesystem/SecureDeleteThread.java'
                include 'com/atakmap/coremap/io/DatabaseInformation.java'
                include 'com/atakmap/coremap/io/IOProvider.java'
                include 'com/atakmap/coremap/io/IOProviderFactory.java'
                include 'com/atakmap/coremap/io/DefaultIOProvider.java'
                include 'com/atakmap/coremap/io/ProviderChangeRequestedListener.java'
                include 'com/atakmap/coremap/locale/LocaleUtil.java'
                include 'com/atakmap/coremap/log/Log.java'
                include 'com/atakmap/coremap/maps/time/CoordinatedTime.java'
                include 'com/atakmap/interop/Pointer.java'
                include 'com/atakmap/util/Collections2.java'
            }
            into 'src/external/java'
        }
    }
}

compileJava.dependsOn(importDepends)

clean {
    delete += fileTree('src/external/java')
}
